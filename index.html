<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>PrimeGlobalPro</title>

<style>
:root{
  --glass-bg: rgba(255,255,255,0.12);
  --glass-border: rgba(255,255,255,0.25);
  --glow-cyan: #00f6ff;
  --glow-violet: #9b7cff;
  --text-main: #ffffff;
  --text-muted: rgba(255,255,255,0.7);
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  color:var(--text-main);
  background:
    radial-gradient(circle at 20% 20%, #6b5cff, transparent 40%),
    radial-gradient(circle at 80% 30%, #00eaff, transparent 45%),
    radial-gradient(circle at 50% 80%, #ff7ad9, transparent 45%),
    #05070c;
  overflow-x:hidden;
}

/* GLASS BASE */
.glass{
  background:var(--glass-bg);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  border:1px solid var(--glass-border);
  border-radius:24px;
}

/* BANK CARD */
.card-wrap{
  padding:20px;
  display:flex;
  justify-content:center;
}

.bank-card{
  width:100%;
  max-width:420px;
  padding:22px;
  position:relative;
  box-shadow:0 0 40px rgba(0,255,255,.25);
}

.card-balance{
  text-align:center;
  font-size:38px;
  font-weight:800;
}

.card-label{
  text-align:center;
  font-size:14px;
  opacity:.8;
}

.vip-badge{
  position:absolute;
  top:14px;
  right:14px;
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  background:linear-gradient(135deg,var(--glow-cyan),var(--glow-violet));
  color:#000;
  font-weight:700;
}

/* ENERGY CORE */
.core-wrap{
  margin:30px 0 110px;
  display:flex;
  justify-content:center;
}

.energy-core{
  width:200px;
  height:200px;
  border-radius:50%;
  background:
    radial-gradient(circle at center, rgba(255,255,255,.9), rgba(255,255,255,.1) 45%, transparent 70%),
    radial-gradient(circle at 30% 30%, var(--glow-cyan), transparent 60%),
    radial-gradient(circle at 70% 70%, var(--glow-violet), transparent 60%);
  box-shadow:
    0 0 40px rgba(0,255,255,.6),
    inset 0 0 30px rgba(255,255,255,.35);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:transform .08s ease;
}

.energy-core:active{
  transform:scale(.96);
}

.tap-info{
  text-align:center;
  margin-top:14px;
  font-size:14px;
  color:var(--text-muted);
}

/* NAV BAR */
.nav-wrap{
  position:fixed;
  bottom:18px;
  left:0;
  right:0;
  display:flex;
  justify-content:center;
}

.nav{
  width:calc(100% - 32px);
  max-width:420px;
  padding:14px 0;
  display:flex;
  justify-content:space-around;
}

.nav .glass{
  display:flex;
  justify-content:space-around;
  width:100%;
}

.nav button{
  background:none;
  border:none;
  color:white;
  font-size:22px;
  opacity:.6;
}

.nav button.active{
  opacity:1;
  text-shadow:0 0 12px var(--glow-cyan);
}
</style>
</head>

<body>

<!-- BANK CARD -->
<div class="card-wrap">
  <div class="bank-card glass">
    <div class="vip-badge" id="vipBadge">VIP 0</div>
    <div class="card-label">Balance</div>
    <div class="card-balance" id="balance">$0.00</div>
  </div>
</div>

<!-- ENERGY CORE -->
<div class="core-wrap">
  <div>
    <div class="energy-core" id="tapCore"></div>
    <div class="tap-info" id="tapInfo">Tap to generate score</div>
  </div>
</div>

<!-- NAV -->
<div class="nav-wrap">
  <div class="nav glass">
    <button class="active">üè†</button>
    <button onclick="location.href='tasks.html'">üìã</button>
    <button onclick="location.href='wallet.html'">üí≥</button>
    <button onclick="location.href='referral.html'">üîó</button>
    <button onclick="location.href='vip.html'">üíé</button>
  </div>
</div>

<!-- FIREBASE + LOGIC -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc, updateDoc, serverTimestamp } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyA1HZLZRY9UADNnDVBnoBIlG3b-bCkojxs",
  authDomain: "primeinvestproject2.firebaseapp.com",
  projectId: "primeinvestproject2",
  storageBucket: "primeinvestproject2.firebasestorage.app",
  messagingSenderId: "798977477628",
  appId: "1:798977477628:web:c97d1fba72ad7865864079"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const SCORE_TO_USD = 10000000;
const DAILY_LIMIT_FREE = 500000;

const MULTI = {
  0:1,1:5,2:10,3:20,4:40,5:80,6:800,7:8000,8:80000
};

function uid(){
  let id = localStorage.getItem("uid");
  if(!id){
    id = "user_"+Date.now()+"_"+Math.random().toString(36).slice(2,8);
    localStorage.setItem("uid",id);
  }
  return id;
}

const userRef = doc(db,"users",uid());

async function init(){
  const snap = await getDoc(userRef);
  if(!snap.exists()){
    await setDoc(userRef,{
      balance:0,
      score:0,
      tapsToday:0,
      lastTapReset:Date.now(),
      vip:{level:0},
      createdAt:serverTimestamp()
    });
  }
}

function resetDaily(user){
  if(Date.now() - (user.lastTapReset||0) > 86400000){
    return { tapsToday:0, lastTapReset:Date.now() };
  }
  return {};
}

async function refreshUI(){
  const snap = await getDoc(userRef);
  const u = snap.data();
  document.getElementById("balance").innerText = "$"+(u.balance||0).toFixed(2);
  document.getElementById("vipBadge").innerText = "VIP "+(u.vip?.level||0);
}

document.getElementById("tapCore").onclick = async ()=>{
  const snap = await getDoc(userRef);
  const u = snap.data();
  const vip = u.vip?.level||0;
  const multi = MULTI[vip];
  const dailyLimit = vip===0 ? DAILY_LIMIT_FREE : Infinity;

  if(u.tapsToday >= dailyLimit) return;

  const gained = multi;
  let score = (u.score||0)+gained;
  let balance = u.balance||0;

  if(score >= SCORE_TO_USD){
    const usd = Math.floor(score/SCORE_TO_USD);
    balance += usd;
    score = score % SCORE_TO_USD;
  }

  await updateDoc(userRef,{
    ...resetDaily(u),
    score,
    balance,
    tapsToday:(u.tapsToday||0)+1
  });

  refreshUI();
};

await init();
await refreshUI();
</script>

</body>
</html>
